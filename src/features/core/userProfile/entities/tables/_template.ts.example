// src/features/core/userProfile/entities/tables/organizerProfile.ts
// このファイルはプロフィールテーブル定義のテンプレートです。
// 新しいロール用プロフィールを追加する際にコピーして使用してください。
//
// 手順:
// 1. roles.config.ts でロールを定義（hasProfile: true, profileFields: [...]）
// 2. このテンプレートをコピーしてテーブル定義を作成
// 3. entities/drizzle.ts で re-export
// 4. drizzle-kit push でDBスキーマを更新

import { UserTable } from "@/features/core/user/entities/drizzle";
import { boolean, pgTable, text, timestamp, uuid } from "drizzle-orm/pg-core";

/**
 * プロフィールテーブル定義
 *
 * フィールドは roles.config.ts の profileFields と対応させてください。
 */
export const OrganizerProfileTable = pgTable("organizer_profiles", {
  // userId は UserTable.id への外部キー（1:1）
  userId: uuid("user_id")
    .primaryKey()
    .references(() => UserTable.id, { onDelete: "cascade" }),

  // --- プロフィールフィールド（roles.config.ts の profileFields に対応）---
  companyName: text("company_name"),
  contactPhone: text("contact_phone"),

  // --- ステータスフィールド（必要に応じて追加）---
  isApproved: boolean("is_approved").default(false).notNull(),
  approvedAt: timestamp("approved_at", { withTimezone: true }),
  approvalNote: text("approval_note"),

  // --- タイムスタンプ ---
  createdAt: timestamp("created_at", { withTimezone: true }).defaultNow(),
  updatedAt: timestamp("updated_at", { withTimezone: true }).defaultNow(),
});
