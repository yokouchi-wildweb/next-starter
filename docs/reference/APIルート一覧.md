# APIãƒ«ãƒ¼ãƒˆä¸€è¦§

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ã™ã¹ã¦ã®APIãƒ«ãƒ¼ãƒˆã¨ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰æ™‚ã®DBå¤‰æ›´æœ‰ç„¡ã®ä¸€è¦§ã§ã™ã€‚

## DBå¤‰æ›´ã®åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯

```
DBå¤‰æ›´ã‚ã‚Š = (æ“ä½œã‚¿ã‚¤ãƒ— === "write") && (ãƒ‡ãƒ¢æ™‚ã‚¹ã‚­ãƒƒãƒ— === false)
```

| æ“ä½œã‚¿ã‚¤ãƒ— | ãƒ‡ãƒ¢æ™‚ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | å®‰å…¨æ€§ |
|------------|----------------|--------|--------|
| read | - | âŒ ãªã— | ğŸŸ¢ å®‰å…¨ |
| write | âœ… ã‚¹ã‚­ãƒƒãƒ— | âŒ ãªã— | ğŸŸ¢ å®‰å…¨ |
| write | âŒ å®Ÿè¡Œ | âš ï¸ ã‚ã‚Š | ğŸ”´ è¦æ³¨æ„ |

---

## å…¨ãƒ«ãƒ¼ãƒˆä¸€è¦§ï¼ˆDBå¤‰æ›´æœ‰ç„¡ä»˜ãï¼‰

### æ±ç”¨CRUDãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/[domain]` | GET | read | - | ğŸŸ¢ ãªã— | ä¸€è¦§å–å¾— |
| `/api/[domain]` | POST | write | âœ… | ğŸŸ¢ ãªã— | æ–°è¦ä½œæˆ |
| `/api/[domain]/[id]` | GET | read | - | ğŸŸ¢ ãªã— | å˜ä¸€å–å¾— |
| `/api/[domain]/[id]` | PUT | write | âœ… | ğŸŸ¢ ãªã— | æ›´æ–° |
| `/api/[domain]/[id]` | DELETE | write | âœ… | ğŸŸ¢ ãªã— | è«–ç†å‰Šé™¤ |
| `/api/[domain]/search` | GET | read | - | ğŸŸ¢ ãªã— | æ¤œç´¢ |
| `/api/[domain]/upsert` | PUT | write | âœ… | ğŸŸ¢ ãªã— | Upsert |
| `/api/[domain]/[id]/duplicate` | POST | write | âœ… | ğŸŸ¢ ãªã— | è¤‡è£½ |
| `/api/[domain]/[id]/hard-delete` | DELETE | write | âœ… | ğŸŸ¢ ãªã— | ç‰©ç†å‰Šé™¤ |
| `/api/[domain]/[id]/restore` | POST | write | âœ… | ğŸŸ¢ ãªã— | å¾©æ—§ |
| `/api/[domain]/bulk/delete-by-ids` | POST | write | âœ… | ğŸŸ¢ ãªã— | ä¸€æ‹¬å‰Šé™¤ |
| `/api/[domain]/bulk/delete-by-query` | POST | write | âœ… | ğŸŸ¢ ãªã— | ã‚¯ã‚¨ãƒªä¸€æ‹¬å‰Šé™¤ |

### èªè¨¼ãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/auth/session` | GET | read | - | ğŸŸ¢ ãªã— | ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾— |
| `/api/auth/register` | POST | write | âœ… | ğŸŸ¢ ãªã— | æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ² |
| `/api/auth/pre-register` | POST | write | âœ… | ğŸŸ¢ ãªã— | äº‹å‰ç™»éŒ² |
| `/api/auth/send-email-link` | POST | write | âœ… | ğŸŸ¢ ãªã— | ãƒ¡ãƒ¼ãƒ«ãƒªãƒ³ã‚¯é€ä¿¡ |
| `/api/auth/demo/login` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | ãƒ‡ãƒ¢ãƒ­ã‚°ã‚¤ãƒ³ |
| `/api/auth/firebase/login` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | Firebaseèªè¨¼ãƒ­ã‚°ã‚¤ãƒ³ |
| `/api/auth/local/login` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | ãƒ­ãƒ¼ã‚«ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ |
| `/api/auth/logout` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ |

### ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/storage/upload` | POST | write | âœ… | ğŸŸ¢ ãªã— | ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ |
| `/api/storage/delete` | POST | write | âœ… | ğŸŸ¢ ãªã— | ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ |

### ç®¡ç†è€…ãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/admin/wallet/[userId]/adjust` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ®‹é«˜èª¿æ•´ |

### ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ»æ±ºæ¸ˆãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/wallet/history/batches` | GET | read | - | ğŸŸ¢ ãªã— | ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå±¥æ­´ä¸€è¦§ |
| `/api/wallet/purchase/[id]/status` | GET | read | - | ğŸŸ¢ ãªã— | è³¼å…¥çŠ¶æ…‹å–å¾—ï¼ˆmilestoneResultså«ã‚€ï¼‰ |
| `/api/wallet/purchase/initiate` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | è³¼å…¥é–‹å§‹ |

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/setting/setup` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— |

### Webhookãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/webhook/payment` | POST | write | âŒ | ğŸ”´ ã‚ã‚Š | æ±ºæ¸ˆWebhook |

### ãã®ä»–ãƒ«ãƒ¼ãƒˆ

| ãƒ‘ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ“ä½œ | ã‚¹ã‚­ãƒƒãƒ— | DBå¤‰æ›´ | èª¬æ˜ |
|------|----------|------|----------|--------|------|
| `/api/demo/get-env` | GET | read | - | ğŸŸ¢ ãªã— | ç’°å¢ƒå¤‰æ•°å–å¾—ï¼ˆé–‹ç™ºç”¨ï¼‰ |

---

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `src/lib/routeFactory/createApiRoute.ts` - åŸºæœ¬ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼
- `src/lib/routeFactory/createDomainRoute.ts` - ãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼
- `src/lib/routeFactory/README.md` - è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
