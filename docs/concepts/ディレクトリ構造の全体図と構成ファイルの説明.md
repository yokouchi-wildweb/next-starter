# ディレクトリ構造の全体図と構成ファイルの説明.md


## 📁 ディレクトリ構成

```tree
src/
├── app/                            # Next.js App Routerのルート
│   ├── layout.tsx                  # 全体レイアウト
│   ├── (user)/                     # 一般ユーザー画面グループ
│   │   ├── page.tsx                # アプリ共通トップページ
│   │   ├── login/page.tsx          # 一般ユーザー向けログイン画面
│   │   ├── signup/page.tsx         # 一般ユーザー向けサインアップ画面
│   │   └── (protected)/            # 認証済みユーザー専用ルートグループ
│   │       └── mypage/page.tsx     # ユーザーマイページ
│   │
│   ├── admin/                      # 管理者向け画面
│   │   ├── login/page.tsx          # 管理者向けログイン画面
│   │   └── (protected)/            # 認証済み管理者専用ルートグループ
│   │       └── [domain]/           # ドメインごとのCRUDなど管理ページ
│   │           ├── page.tsx            # 一覧ページ
│   │           ├── new/page.tsx        # 作成ページ
│   │           └── [id]/edit/page.tsx  # 編集ページ
│   │
│   └── api/                        # APIエンドポイント（REST準拠）
│       ├── [domain]/               # 汎用CRUD API（共通処理）
│       │   ├── route.ts            # 一覧取得・作成（GET, POST）
│       │   ├── [id]/route.ts       # 詳細取得・更新・削除（GET, PUT, DELETE）
│       │   ├── search/route.ts     # データ検索（GET）
│       │   ├── upsert/route.ts     # 更新または作成（PUT）
│       │   ├── bulk/delete/route.ts  # バルク処理 一括DELETEなど
│       │   └── etc... 
│       │
│       └── sample/             # 特殊処理はドメイン専用ルートで定義
│           └── xxxxx/route.ts  # 固有処理のAPI
│
├── features/               # ドメイン別の機能集約
│   └── sample/             # サンプルドメイン
│       ├── components/                # UI部品
│       │   ├── AdminSampleList/       # セクションコンテナ（サンプル一覧）
│       │   │   ├── index.tsx          # 一覧セクション本体（単一タグで提供）
│       │   │   ├── Header.tsx         # セクションタイトルや操作リンク
│       │   │   └── Table.tsx          # テーブル構造と操作ボタン
│       │   ├── AdminSampleCreate/     # セクションコンテナ（サンプル作成画面）
│       │   │   └── index.tsx          # 内部で `common/CreateSampleForm` を使用
│       │   ├── AdminSampleEdit/       # セクションコンテナ（サンプル編集画面）
│       │   │   └── index.tsx          # 内部で `common/EditSampleForm` を使用
│       │   └── common/                # ドメイン全体で使い回すフォームUI
│       │       ├── SampleForm.tsx     # 共通フォームレイアウト
│       │       ├── SampleFields.tsx   # 入力フィールド群
│       │       ├── CreateSampleForm.tsx  # 汎用のドメイン新規作成フォーム
│       │       └── EditSampleForm.tsx    # 汎用のドメイン更新フォーム
│       │
│       ├── entities/                 # ドメインデータとスキーマ定義
│       │   ├── index.ts           # 各エンティティの再エクスポート
│       │   ├── model.ts           # アプリ内で使用するドメインモデル
│       │   ├── schema.ts          # Zodを用いたバリデーションスキーマ
│       │   ├── form.ts            # フォーム処理用 Zodスキーマから推論したフォーム入力型
│       │   ├── drizzle.ts         # DBの構造定義 Drizzle用（DBの種類に応じて）
│       │   └── firestore.ts       # DBの構造定義 Firestore用（DBの種類に応じて）
│       │
│       ├── services/                # API通信とサーバーロジックの集約
│       │   ├── client/                 # クライアント環境用のサービス
│       │   │   └── sampleClient.ts     # 汎用APIクライアント（createApiClientで生成）
│       │   │
│       │   └── server/                 # サーバー側サービス（DBアクセスなど）
│       │       ├── drizzleBase.ts      # 共通 CRUD の土台
│       │       └── sampleService.ts    # ドメイン固有ロジックの公開口
│       │
│       ├── hooks/                # フック類 CRUDは`src/lib/crud/hooks/`配下をラップして作成
│       │   ├── useSampleList.ts          # 一覧取得用フック
│       │   ├── useCreateSample.ts     # 作成処理のラッパーフック
│       │   ├── useUpdateSample.ts     # 更新処理のラッパーフック
│       │   └── useDeleteSample.ts     # 削除処理のラッパーフック
│       │
│       └── tests/  # ドメイン固有の単体テスト（必要に応じて追加）
│
├── components/     # 共通UIコンポーネント
│   ├── [name]/     # 自作汎用部品
│   └── shadcn/     # `shadcn` の生成コンポーネント
│
├── lib/            # ライブラリ（共通ユーティリティ群）
│   ├── cn/             # クラス名結合ヘルパー
│   ├── crud/           # 汎用 CRUD 共通処理
│   ├── drizzle/        # Drizzle ORM 初期化やユーティリティ
│   ├── errors/         # エラー型とハンドリング共通処理
│   ├── firebase/       # Firebase 関連 (client/, server/)
│   ├── jwt/            # JWT の生成・検証ユーティリティ
│   ├── localStorage/   # ローカルストレージ関連のヘルパー
│   └── storage/        # Firebase Storage（デフォルトで使用される想定）の操作を集約
│
├── config/        # 全体設定ファイル
│   ├── admin-global-menu.config.ts  # 管理画面メニュー定義
│   └── app-features.config.ts       # 機能フラグなどのアプリ設定
│
├── registry/      # 各種レジストリとメニュー定義
│   ├── adminDataMenu.ts             # 管理画面メニュー定義
│   ├── serviceRegistry.ts           # ドメイン→サービス登録用レジストリ
│   └── schemaRegistry.ts            # Drizzleスキーマ登録用レジストリ
│
├── stores/               # グローバルなZustandストア
│   ├── useXxxxxStore.ts  # Zustand本体 create() のみ
│   └── useXxxxx.ts       # ストアと対になるフック相当のラッパーでUIから使用される
│
├── styles/      # グローバルCSSとテーマ定義
│   ├── admin.css        # 管理画面向けのレイアウト調整
│   ├── animations.css   # アニメーションとキーフレーム定義
│   ├── base.css         # @layer base の共通スタイル
│   ├── components.css   # @layer components の共通スタイル
│   ├── config.css       # Tailwind設定値の共有トークン
│   ├── global.css       # Tailwind読み込みと全体の入口
│   ├── theme.css        # カラーパレットやフォント設定
│   └── utilities.css    # @layer utilities のユーティリティ
├── hooks/       # 再利用可能な汎用フック
├── utils/       # 汎関数
├── constants/   # 定数群
└── types/       # グローバルスタイル（Tailwind）
```
